function eveorg_getParameterByName(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n="[\\?&]"+e+"=([^&#]*)";var r=new RegExp(n);var i=r.exec(t);if(i===null)return"";else return decodeURIComponent(i[1].replace(/\+/g," "))}function eo_load_map(){var e=eventorganiser.map;for(var t=0;t<e.length;t++){if(null===document.getElementById("eo_venue_map-"+(t+1))){continue}eventorganiser.map[t].markers={};var n=e[t].locations;var r={zoom:e[t].zoom,scrollwheel:e[t].scrollwheel,zoomControl:e[t].zoomcontrol,rotateControl:e[t].rotatecontrol,panControl:e[t].pancontrol,overviewMapControl:e[t].overviewmapcontrol,streetViewControl:e[t].streetviewcontrol,draggable:e[t].draggable,mapTypeControl:e[t].maptypecontrol,mapTypeId:google.maps.MapTypeId[e[t].maptypeid]};r=wp.hooks.applyFilters("eventorganiser.google_map_options",r);var i=new google.maps.Map(document.getElementById("eo_venue_map-"+(t+1)),r);if(n.length>1){var s=new google.maps.LatLngBounds;for(var o=0;o<n.length;o++){if(n[o].lat!==undefined&&n[o].lng!==undefined){var u=new google.maps.LatLng(n[o].lat,n[o].lng);s=s.extend(u)}}i.fitBounds(s)}else{i.setCenter(new google.maps.LatLng(n[0].lat,n[0].lng))}for(var a=0;a<n.length;a++){var f=n[a].lat;var l=n[a].lng;if(f!==undefined&&l!==undefined){var u=new google.maps.LatLng(f,l);var c={venue_id:n[a].venue_id,position:u,map:i,content:n[a].tooltipContent,icon:n[a].icon};c=wp.hooks.applyFilters("eventorganiser.venue_marker_options",c);(function(){var r=new google.maps.Marker(c);eventorganiser.map[t].markers[n[a].venue_id]=r;if(e[t].tooltip){var s=new google.maps.InfoWindow({content:n[a].tooltipContent,maxWidth:200});google.maps.event.addListener(r,"click",function(){s.open(i,r)})}})()}}}}if(typeof EO_SCRIPT_DEBUG==="undefined"){EO_SCRIPT_DEBUG=true}var eventorganiser=eventorganiser||{};(function(e){jQuery(document).ready(function(){function t(t){var n=t.categories;var r=typeof t.category!=="undefined"&&t.category?t.category.split(","):false;var i="<select class='eo-cal-filter' id='eo-event-cat'>";i+="<option value=''>"+t.buttonText.cat+"</option>";var s;for(var o in n){s=n[o];if(r){var u=false;if(e.inArray(s.slug,r)!==-1){u=true}var a=s;while(!u&&a.parent>0){a=n[a.parent];if(e.inArray(a.slug,r)!==-1){u=true}}if(!u){continue}}i+="<option class='cat-colour-"+s.colour+" cat' value='"+s.slug+"'>"+s.name+"</option>"}i+="</select>";var f=e("<span class='fc-header-dropdown filter-category'></span>");f.append(i);return f}function n(){var t=e("<span class='fc-header-goto'><input type='hidden' class='eo-mini-calendar'/></span>");return t}function r(t){var n=t.tags;var r="<select class='eo-cal-filter' data-filter-type='event-tag'>";r+="<option value=''>"+t.buttonText.tag+"</option>";for(var i=0;i<n.length;i++){r+="<option value='"+n[i].slug+"'>"+n[i].name+"</option>"}r+="</select>";var s=e("<span class='fc-header-dropdown filter-tag'></span>");s.append(r);return s}function i(t){var n=t.venues;var r="<select class='eo-cal-filter' id='eo-event-venue'>";r+="<option value=''>"+t.buttonText.venue+"</option>";var i=typeof t.venue!=="undefined"&&t.venue?t.venue.split(","):false;for(var s=0;s<n.length;s++){if(i&&e.inArray(n[s].slug,i)===-1){continue}r+="<option value='"+n[s].term_id+"'>"+n[s].name+"</option>"}r+="</select>";var o=e("<span class='fc-header-dropdown filter-venue'></span>");o.append(r);return o}if(e("#eo-upcoming-dates").length>0&&e("#eo-upcoming-dates").find("li:gt(4)").length>0){var s=5;var o={more:EOAjaxFront.locale.ShowMore,less:EOAjaxFront.locale.ShowLess};e("#eo-upcoming-dates").find("li:gt("+(s-1)+")").hide().end().after(e('<a href="#" id="eo-upcoming-dates-less">'+o.less+'</a> <span id="eo-upcoming-dates-pipe">|</span> <a href="#" id="eo-upcoming-dates-more">'+o.more+"</a>"));e("#eo-upcoming-dates-pipe").hide();e("#eo-upcoming-dates-less").hide().click(function(t){t.preventDefault();var n=Math.floor((e("#eo-upcoming-dates li:visible").length-1)/s)*s-1;e("#eo-upcoming-dates li:gt("+n+")").hide();e("#eo-upcoming-dates-more,#eo-upcoming-dates-pipe").show();if(e("#eo-upcoming-dates li:visible").length<=s){e("#eo-upcoming-dates-less,#eo-upcoming-dates-pipe").hide()}});e("#eo-upcoming-dates-more").click(function(t){t.preventDefault();e("#eo-upcoming-dates-less,#eo-upcoming-dates-pipe, #eo-upcoming-dates li:hidden:lt("+s+")").show();var n=e("#eo-upcoming-dates-pipe").offset();e("html, body").animate({scrollTop:Math.max(n.top+40-e(window).height(),e(window).scrollTop())});if(e("#eo-upcoming-dates li:hidden").length===0){e("#eo-upcoming-dates-more,#eo-upcoming-dates-pipe").hide()}})}if(e(".eo-fullcalendar").length>0){var u=eventorganiser.calendars;var a;for(var f=0;f<u.length;f++){var l="#eo_fullcalendar_"+(f+1);if(typeof u[f].category==="undefined"){u[f].category=""}if(typeof u[f].venue==="undefined"){u[f].venue=""}var c={id:l,year:u[f].year?u[f].year:undefined,month:u[f].month?u[f].month:undefined,date:u[f].date?u[f].date:undefined,category:u[f].event_category,venue:u[f].event_venue,customButtons:{tag:r,category:t,venue:i,"goto":n},theme:u[f].theme,categories:eventorganiser.fullcal.categories,venues:eventorganiser.fullcal.venues,tags:eventorganiser.fullcal.tags,timeFormatphp:u[f].timeformatphp,timeFormat:u[f].timeformat,isRTL:u[f].isrtl,editable:false,tooltip:u[f].tooltip,firstDay:parseInt(eventorganiser.fullcal.firstDay,10),weekends:u[f].weekends,allDaySlot:u[f].alldayslot,allDayText:u[f].alldaytext,axisFormat:u[f].axisformat,minTime:u[f].mintime,maxTime:u[f].maxtime,columnFormat:{month:u[f].columnformatmonth,week:u[f].columnformatweek,day:u[f].columnformatday},titleFormat:{month:u[f].titleformatmonth,week:u[f].titleformatweek,day:u[f].titleformatday},header:{left:u[f].headerleft,center:u[f].headercenter,right:u[f].headerright},eventRender:function(t,n,r){var i=e(r.calendar.options.id).find(".filter-category .eo-cal-filter").val();var s=e(r.calendar.options.id).find(".filter-venue .eo-cal-filter").val();var o=e(r.calendar.options.id).find(".filter-tag .eo-cal-filter").val();if(typeof i!=="undefined"&&i!==""&&e.inArray(i,t.category)<0){return"<div></div>"}if(typeof s!=="undefined"&&s!==""&&s!=t.venue){return"<div></div>"}if(typeof o!=="undefined"&&o!==""&&e.inArray(o,t.tags)<0){return"<div></div>"}if(!wp.hooks.applyFilters("eventorganiser.fullcalendar_render_event",true,t,n,r))return"<div></div>";if(!r.calendar.options.tooltip){return}e(n).qtip({content:{text:t.description,button:false,title:t.title},position:{my:"top center",at:"bottom center",viewport:e(window),adjust:{method:"shift none"}},hide:{fixed:true,delay:500,effect:function(t){e(this).fadeOut("50")}},border:{radius:4,width:3},style:{classes:"eo-event-toolip ui-tooltip-shadow",widget:true,tip:"topMiddle"}})},buttonText:{today:EOAjaxFront.locale.today,month:EOAjaxFront.locale.month,week:EOAjaxFront.locale.week,day:EOAjaxFront.locale.day,cat:EOAjaxFront.locale.cat,venue:EOAjaxFront.locale.venue,tag:EOAjaxFront.locale.tag},monthNames:EOAjaxFront.locale.monthNames,monthNamesShort:EOAjaxFront.locale.monthAbbrev,dayNames:EOAjaxFront.locale.dayNames,dayNamesShort:EOAjaxFront.locale.dayAbbrev,eventColor:"#21759B",defaultView:u[f].defaultview,lazyFetching:"true",events:function(t,n,r,i){var s={start:jQuery.fullCalendar.formatDate(t,"yyyy-MM-dd"),end:jQuery.fullCalendar.formatDate(n,"yyyy-MM-dd"),timeformat:i.timeFormatphp,users_events:i.users_events};if(typeof i.category!=="undefined"&&i.category!==""){s.category=i.category}if(typeof i.venue!=="undefined"&&i.venue!==""){s.venue=i.venue}s=wp.hooks.applyFilters("eventorganiser.fullcalendar_request",s,t,n,r,i);e.ajax({url:eventorganiser.ajaxurl+"?action=eventorganiser-fullcal",dataType:"JSON",data:s,success:r,complete:function(e,t){if(EO_SCRIPT_DEBUG){if(t=="error"){}else if(t=="parsererror"){if(window.console){console.log("Response is not valid JSON. This is usually caused by error notices from WordPress or other plug-ins");console.log("Response reads: "+e.responseText)}alert("An error has occurred in parsing the response. Please inspect console log for details")}}}})},selectable:false,weekMode:"variable",aspectRatio:1.5,loading:function(t){var n=e("#"+e(this).attr("id")+"_loading");if(t){window.clearTimeout(a);a=window.setTimeout(function(){n.show()},1e3)}else{window.clearTimeout(a);n.hide()}}};c=wp.hooks.applyFilters("eventorganiser.fullcalendar_options",c,u[f]);e(l).fullCalendar(c)}e(".eo-cal-filter").change(function(){e(".eo-fullcalendar").fullCalendar("rerenderEvents")});e(".eo-mini-calendar").datepicker({dateFormat:"DD, d MM, yy",changeMonth:true,changeYear:true,firstDay:parseInt(eventorganiser.fullcal.firstDay,10),buttonText:EOAjaxFront.locale.gotodate,monthNamesShort:EOAjaxFront.locale.monthAbbrev,dayNamesMin:EOAjaxFront.locale.dayAbbrev,nextText:EOAjaxFront.locale.nextText,prevText:EOAjaxFront.locale.prevText,showOn:"button",beforeShow:function(t,n){if(n.hasOwnProperty("dpDiv")){n.dpDiv.addClass("eo-datepicker")}else{e("#ui-datepicker-div").addClass("eo-datepicker")}},onSelect:function(t,n){var r=e(this).parents("div.eo-fullcalendar").attr("id");e("#"+r).fullCalendar("gotoDate",new Date(Date.parse(t)))}})}if(e(".eo_widget_calendar").length>0){e(".eo_widget_calendar tfoot").unbind("click");e(".eo_widget_calendar").off("click").on("click","tfoot a",function(t){t.preventDefault();var n=e(this).closest(".eo_widget_calendar").attr("id");var r={showpastevents:1,"show-long":0,"link-to-single":0};if(typeof EOAjax!=="undefined"&&typeof eventorganiser.widget_calendars!=="undefined"){r=eventorganiser.widget_calendars[n]}if(typeof eo_widget_cal!=="undefined"){r=eo_widget_cal[n]}r.eo_month=eveorg_getParameterByName("eo_month",e(this).attr("href"));e.getJSON(EOAjaxFront.adminajax+"?action=eo_widget_cal",r,function(t){e("#"+n+"_content").html(t)})})}if(e(".eo-agenda-widget").length>0){function h(t,n){e.ajax({url:EOAjaxFront.adminajax,dataType:"JSON",data:{action:"eo_widget_agenda",instance_number:n.number,direction:t,start:n.StartDate,end:n.EndDate},success:function(e){if(!jQuery.isArray(e)||!e[0]){return false}else{n.StartDate=e[0].StartDate;n.EndDate=e[e.length-1].StartDate;p(e,n)}}})}function p(t,n){var r=e("#"+n.id+"_container");var i=r.find("ul.dates");var s=i.find("li");e(s).remove();var o=false;for(f=0;f<t.length;f++){var u=new Date(t[f].StartDate),a,l;if(o===false||o!=t[f].StartDate&&n.mode=="day"){o=t[f].StartDate;a=e('<li class="date" >'+t[f].display+'<ul class="a-date"></ul></li>');i.append(a)}if(n.add_to_google){l=e('<li class="event"></li>').append('<span class="cat"></span><span><strong>'+t[f].time+": </strong></span>"+t[f].post_title).append('<div class="meta" style="display:none;"><span>'+t[f].link+"</span><span>   </span><span>"+t[f].Glink+"</span></div>")}else{l=e('<li class="event"></li>').append("<a class='eo-agenda-event-permalink' href='"+t[f].event_url+"'><span class='cat'></span><span><strong>"+t[f].time+": </strong></span>"+t[f].post_title+"</a>")}l.find("span.cat").css({background:t[f].color});a.append(l)}s=i.find("li");var c=r.find("ul li.event");c.on("click",function(){e(this).find(".meta").toggle("400")})}for(var d in eo_widget_agenda){d=eo_widget_agenda[d];var v=new Date;d.StartDate=e.fullCalendar.formatDate(v,"yyyy-MM-dd");d.EndDate=d.StartDate;h(1,d)}e(".eo-agenda-widget .agenda-nav span.button").click(function(t){var n=e(this).parents(".eo-agenda-widget").attr("id");d=eo_widget_agenda[n];t.preventDefault();var r=false;if(e(this).hasClass("next")){r="+1"}else if(e(this).hasClass("prev")){r="-1"}else{var i=e(this).parent();if(i.hasClass("prev")){r="-1"}else{r="+1"}}h(r,d)})}})})(jQuery)

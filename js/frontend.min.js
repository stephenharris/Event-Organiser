/*! event-organiser 2.8.2 2014-06-29 16:59 */
function eveorg_getParameterByName(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),e=d.exec(b);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))}function eo_load_map(){for(var a=eventorganiser.map,b=0;b<a.length;b++)if(null!==document.getElementById("eo_venue_map-"+(b+1))){eventorganiser.map[b].markers={};var c=a[b].locations,d={zoom:a[b].zoom,scrollwheel:a[b].scrollwheel,zoomControl:a[b].zoomcontrol,rotateControl:a[b].rotatecontrol,panControl:a[b].pancontrol,overviewMapControl:a[b].overviewmapcontrol,streetViewControl:a[b].streetviewcontrol,draggable:a[b].draggable,mapTypeControl:a[b].maptypecontrol,mapTypeId:google.maps.MapTypeId[a[b].maptypeid],disableAutoPan:a[b].disableautopan};d=wp.hooks.applyFilters("eventorganiser.google_map_options",d);var e=new google.maps.Map(document.getElementById("eo_venue_map-"+(b+1)),d);if(a[b].centerlng&&a[b].centerlat)e.setCenter(new google.maps.LatLng(a[b].centerlat,a[b].centerlng));else if(c.length>1){for(var f=new google.maps.LatLngBounds,g=0;g<c.length;g++){var h=new google.maps.LatLng(c[g].lat,c[g].lng);f=f.extend(h)}e.fitBounds(f)}else e.setCenter(new google.maps.LatLng(c[0].lat,c[0].lng));for(var i=0;i<c.length;i++){var j=c[i].lat,k=c[i].lng;if(void 0!==j&&void 0!==k){var h=new google.maps.LatLng(j,k),l={venue_id:c[i].venue_id,position:h,map:e,content:c[i].tooltipContent,icon:c[i].icon};l=wp.hooks.applyFilters("eventorganiser.venue_marker_options",l),function(){var f=new google.maps.Marker(l);if(eventorganiser.map[b].markers[c[i].venue_id]=f,a[b].tooltip){var g=new google.maps.InfoWindow({content:c[i].tooltipContent,maxWidth:200,disableAutoPan:d.disableAutoPan});google.maps.event.addListener(f,"click",function(){g.open(e,f)})}}()}}}}var eventorganiser=eventorganiser||{};!function(a){jQuery(document).ready(function(){function b(b){var c=b.categories,d="undefined"!=typeof b.category&&b.category?b.category.split(","):!1,e="<select class='eo-cal-filter' id='eo-event-cat'>";e+="<option value=''>"+b.buttonText.cat+"</option>";var f;for(var g in c){if(f=c[g],d){var h=!1;-1!==a.inArray(f.slug,d)&&(h=!0);for(var i=f;!h&&i.parent>0;)i=c[i.parent],-1!==a.inArray(i.slug,d)&&(h=!0);if(!h)continue}e+="<option class='cat-colour-"+f.colour+" cat' value='"+f.slug+"'>"+f.name+"</option>"}e+="</select>";var j=a("<span class='fc-header-dropdown filter-category'></span>");return j.append(e),j}function c(){var b=a("<span class='fc-header-goto'><input type='hidden' class='eo-mini-calendar'/></span>");return b}function d(b){var c=b.tags,d="<select class='eo-cal-filter' data-filter-type='event-tag'>";d+="<option value=''>"+b.buttonText.tag+"</option>";for(var e=0;e<c.length;e++)d+="<option value='"+c[e].slug+"'>"+c[e].name+"</option>";d+="</select>";var f=a("<span class='fc-header-dropdown filter-tag'></span>");return f.append(d),f}function e(b){var c=b.venues,d="<select class='eo-cal-filter' id='eo-event-venue'>";d+="<option value=''>"+b.buttonText.venue+"</option>";for(var e="undefined"!=typeof b.venue&&b.venue?b.venue.split(","):!1,f=0;f<c.length;f++)e&&-1===a.inArray(c[f].slug,e)||(d+="<option value='"+c[f].term_id+"'>"+c[f].name+"</option>");d+="</select>";var g=a("<span class='fc-header-dropdown filter-venue'></span>");return g.append(d),g}function f(b,c){a.ajax({url:EOAjaxFront.adminajax,dataType:"JSON",data:{action:"eo_widget_agenda",instance_number:c.number,direction:b,start:c.StartDate,end:c.EndDate},success:function(a){return jQuery.isArray(a)&&a[0]?(c.StartDate=a[0].StartDate,c.EndDate=a[a.length-1].StartDate,g(a,c),void 0):!1}})}function g(b,c){var d=a("#"+c.id+"_container"),e=d.find("ul.dates"),f=e.find("li");a(f).remove();var g=!1;for(l=0;l<b.length;l++){{var h,i;new Date(b[l].StartDate)}(g===!1||g!=b[l].StartDate&&"day"==c.mode)&&(g=b[l].StartDate,h=a('<li class="date" >'+b[l].display+'<ul class="a-date"></ul></li>'),e.append(h)),i=c.add_to_google?a('<li class="event"></li>').append('<span class="cat"></span><span><strong>'+b[l].time+": </strong></span>"+b[l].post_title).append('<div class="meta" style="display:none;"><span>'+b[l].link+"</span><span> Â  </span><span>"+b[l].Glink+"</span></div>"):a('<li class="event"></li>').append("<a class='eo-agenda-event-permalink' href='"+b[l].event_url+"'><span class='cat'></span><span><strong>"+b[l].time+": </strong></span>"+b[l].post_title+"</a>"),i.find("span.cat").css({background:b[l].color}),h.append(i)}f=e.find("li");var j=d.find("ul li.event");j.on("click",function(){a(this).find(".meta").toggle("400")})}if(a("#eo-upcoming-dates").length>0&&a("#eo-upcoming-dates").find("li:gt(4)").length>0){var h=5,i={more:EOAjaxFront.locale.ShowMore,less:EOAjaxFront.locale.ShowLess};a("#eo-upcoming-dates").find("li:gt("+(h-1)+")").hide().end().after(a('<a href="#" id="eo-upcoming-dates-less">'+i.less+'</a> <span id="eo-upcoming-dates-pipe">|</span> <a href="#" id="eo-upcoming-dates-more">'+i.more+"</a>")),a("#eo-upcoming-dates-pipe").hide(),a("#eo-upcoming-dates-less").hide().click(function(b){b.preventDefault();var c=Math.floor((a("#eo-upcoming-dates li:visible").length-1)/h)*h-1;a("#eo-upcoming-dates li:gt("+c+")").hide(),a("#eo-upcoming-dates-more,#eo-upcoming-dates-pipe").show(),a("#eo-upcoming-dates li:visible").length<=h&&a("#eo-upcoming-dates-less,#eo-upcoming-dates-pipe").hide()}),a("#eo-upcoming-dates-more").click(function(b){b.preventDefault(),a("#eo-upcoming-dates-less,#eo-upcoming-dates-pipe, #eo-upcoming-dates li:hidden:lt("+h+")").show();var c=a("#eo-upcoming-dates-pipe").offset();a("html, body").animate({scrollTop:Math.max(c.top+40-a(window).height(),a(window).scrollTop())}),0===a("#eo-upcoming-dates li:hidden").length&&a("#eo-upcoming-dates-more,#eo-upcoming-dates-pipe").hide()})}if(a(".eo-fullcalendar").length>0){for(var j,k=eventorganiser.calendars,l=0;l<k.length;l++){var m="#eo_fullcalendar_"+(l+1);"undefined"==typeof k[l].category&&(k[l].category=""),"undefined"==typeof k[l].venue&&(k[l].venue="");var n={id:m,year:k[l].year?k[l].year:void 0,month:k[l].month?k[l].month:void 0,date:k[l].date?k[l].date:void 0,category:k[l].event_category,venue:k[l].event_venue,customButtons:{tag:d,category:b,venue:e,"goto":c},theme:k[l].theme,categories:eventorganiser.fullcal.categories,venues:eventorganiser.fullcal.venues,tags:eventorganiser.fullcal.tags,timeFormatphp:k[l].timeformatphp,timeFormat:k[l].timeformat,isRTL:k[l].isrtl,editable:!1,tooltip:k[l].tooltip,firstDay:parseInt(eventorganiser.fullcal.firstDay,10),weekends:k[l].weekends,allDaySlot:k[l].alldayslot,allDayText:k[l].alldaytext,axisFormat:k[l].axisformat,minTime:k[l].mintime,maxTime:k[l].maxtime,columnFormat:{month:k[l].columnformatmonth,week:k[l].columnformatweek,day:k[l].columnformatday},titleFormat:{month:k[l].titleformatmonth,week:k[l].titleformatweek,day:k[l].titleformatday},header:{left:k[l].headerleft,center:k[l].headercenter,right:k[l].headerright},eventRender:function(b,c,d){var e=a(d.calendar.options.id).find(".filter-category .eo-cal-filter").val(),f=a(d.calendar.options.id).find(".filter-venue .eo-cal-filter").val(),g=a(d.calendar.options.id).find(".filter-tag .eo-cal-filter").val();return"undefined"!=typeof e&&""!==e&&a.inArray(e,b.category)<0?"<div></div>":"undefined"!=typeof f&&""!==f&&f!=b.venue?"<div></div>":"undefined"!=typeof g&&""!==g&&a.inArray(g,b.tags)<0?"<div></div>":wp.hooks.applyFilters("eventorganiser.fullcalendar_render_event",!0,b,c,d)?void(d.calendar.options.tooltip&&a(c).qtip({content:{text:b.description,button:!1,title:b.title},position:{my:"top center",at:"bottom center",viewport:a(window),adjust:{method:"shift none"}},hide:{fixed:!0,delay:500,effect:function(){a(this).fadeOut("50")}},border:{radius:4,width:3},style:{classes:"eo-event-toolip ui-tooltip-shadow",widget:!0,tip:"topMiddle"}})):"<div></div>"},buttonText:{today:EOAjaxFront.locale.today,month:EOAjaxFront.locale.month,week:EOAjaxFront.locale.week,day:EOAjaxFront.locale.day,cat:EOAjaxFront.locale.cat,venue:EOAjaxFront.locale.venue,tag:EOAjaxFront.locale.tag},monthNames:EOAjaxFront.locale.monthNames,monthNamesShort:EOAjaxFront.locale.monthAbbrev,dayNames:EOAjaxFront.locale.dayNames,dayNamesShort:EOAjaxFront.locale.dayAbbrev,eventColor:"#21759B",defaultView:k[l].defaultview,lazyFetching:"true",events:function(b,c,d,e){var f={start:jQuery.fullCalendar.formatDate(b,"yyyy-MM-dd"),end:jQuery.fullCalendar.formatDate(c,"yyyy-MM-dd"),timeformat:e.timeFormatphp,users_events:e.users_events};"undefined"!=typeof e.category&&""!==e.category&&(f.category=e.category),"undefined"!=typeof e.venue&&""!==e.venue&&(f.venue=e.venue),f=wp.hooks.applyFilters("eventorganiser.fullcalendar_request",f,b,c,d,e),a.ajax({url:eventorganiser.ajaxurl+"?action=eventorganiser-fullcal",dataType:"JSON",data:f,success:d,complete:function(a,b){}})},selectable:!1,weekMode:"variable",aspectRatio:1.5,loading:function(b){var c=a("#"+a(this).attr("id")+"_loading");b?(window.clearTimeout(j),j=window.setTimeout(function(){c.show()},1e3)):(window.clearTimeout(j),c.hide())}};n=wp.hooks.applyFilters("eventorganiser.fullcalendar_options",n,k[l]),a(m).fullCalendar(n)}a(".eo-cal-filter").change(function(){a(".eo-fullcalendar").fullCalendar("rerenderEvents")}),a(".eo-mini-calendar").datepicker({dateFormat:"DD, d MM, yy",changeMonth:!0,changeYear:!0,firstDay:parseInt(eventorganiser.fullcal.firstDay,10),buttonText:EOAjaxFront.locale.gotodate,monthNamesShort:EOAjaxFront.locale.monthAbbrev,dayNamesMin:EOAjaxFront.locale.dayAbbrev,nextText:EOAjaxFront.locale.nextText,prevText:EOAjaxFront.locale.prevText,showOn:"button",beforeShow:function(b,c){c.hasOwnProperty("dpDiv")?c.dpDiv.addClass("eo-datepicker"):a("#ui-datepicker-div").addClass("eo-datepicker")},onSelect:function(b){var c=a(this).parents("div.eo-fullcalendar").attr("id");a("#"+c).fullCalendar("gotoDate",new Date(Date.parse(b)))}})}if(a(".eo_widget_calendar").length>0&&(a(".eo_widget_calendar tfoot").unbind("click"),a(".eo_widget_calendar").off("click").on("click","tfoot a",function(b){b.preventDefault();var c=a(this).closest(".eo_widget_calendar").attr("id"),d={showpastevents:1,"show-long":0,"link-to-single":0};"undefined"!=typeof eventorganiser.widget_calendars&&"undefined"!=typeof eventorganiser.widget_calendars[c]&&(d=eventorganiser.widget_calendars[c]),"undefined"!=typeof eo_widget_cal&&"undefined"!=typeof eo_widget_cal[c]&&(d=eo_widget_cal[c]),d.eo_month=eveorg_getParameterByName("eo_month",a(this).attr("href")),a.getJSON(EOAjaxFront.adminajax+"?action=eo_widget_cal",d,function(b){a("#"+c+"_content").html(b)})})),a(".eo-agenda-widget").length>0){for(var o in eo_widget_agenda){o=eo_widget_agenda[o];var p=new Date;o.StartDate=a.fullCalendar.formatDate(p,"yyyy-MM-dd"),o.EndDate=o.StartDate,f(1,o)}a(".eo-agenda-widget .agenda-nav span.button").click(function(b){var c=a(this).parents(".eo-agenda-widget").attr("id");o=eo_widget_agenda[c],b.preventDefault();var d=!1;if(a(this).hasClass("next"))d="+1";else if(a(this).hasClass("prev"))d="-1";else{var e=a(this).parent();d=e.hasClass("prev")?"-1":"+1"}f(d,o)})}})}(jQuery);
/*! event-organiser 2.8.2 2014-06-29 16:59 */
var eo_include_dates,eo_exclude_dates,eo_viewing_month;!function(a){function b(b,c,d){var e,f=new Array("SU","MO","TU","WE","TH","FR","SA"),g=[],h=!1;switch(b.schedule){case"once":case"custom":var i=a.datepicker.formatDate("yy-mm-dd",b.start);return g.push(i),g;case"daily":b.start<c?(e=Math.abs((c-b.start)/864e5)-1,e%=b.frequency):e=parseInt(b.start.getDate(),10);var j=b.frequency,k=[],l=new Date(c);l.setDate(c.getDate()+(e-1)),k.push(l);break;case"weekly":var m=c.getDay();k=[],a.each(b.schedule_meta,function(a,d){a=f.indexOf(d),l=new Date(b.start),l.setDate(b.start.getDate()+(a-b.start.getDay()+7)%7),c>l&&(e=Math.abs((c-b.start)/864e5),e-=e%(7*b.frequency),l.setDate(l.getDate()+e)),k.push(l)}),j=7*b.frequency;break;case"monthly":var n=12*(c.getFullYear()-b.start.getFullYear())+(c.getMonth()-b.start.getMonth());if(n%b.frequency!==0)return;if(b.schedule_meta.match(/BYMONTHDAY=(\d+)/)){var o=b.start.getDate(),p=d.getDate();p>=o&&(h=new Date(c.getFullYear(),c.getMonth(),o))}else{var q,r=b.schedule_meta.match(/BYDAY=(\d+)(MO|TU|WE|TH|FR|SA|SU)/),s=parseInt(r[1],10)-1,t=b.start.getDay();if(s>=4){var u=d.getDay();q=d.getDate()+(t-u-7)%7}else{m=c.getDay();var v=(t-m+7)%7;q=v+7*s+1}h=new Date(c),h.setDate(q)}return h&&h<=b.schedule_last&&(i=a.datepicker.formatDate("yy-mm-dd",h),g.push(i)),g;case"yearly":var w=c.getFullYear()-b.start.getFullYear();if(w%b.frequency!==0)return g;var x=new Date(c.getFullYear(),b.start.getMonth(),b.start.getDate());return c.getMonth()==b.start.getMonth()&&x.getMonth()==b.start.getMonth()&&(h=new Date(b.start),h.setYear(c.getFullYear()),h<=b.schedule_last&&(i=a.datepicker.formatDate("yy-mm-dd",h),g.push(i))),g;default:return g}for(var y in k)for(h=new Date(k[y]);d>=h&&h<=b.schedule_last;)i=a.datepicker.formatDate("yy-mm-dd",h),g.push(i),h.setDate(h.getDate()+j);return g}Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),Date.prototype.eoGetOrdinal=function(){var a=this.getDate();switch(a){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},window.eventOrganiserSchedulePicker={init:function(b){var c=this;this.options=b,this.schedule=b.schedule,this.set_up_datepickers(),this.set_up_timepickers(),a(".event-date :input, .eo-all-day-toggle").change(function(){c.update_schedule(),c.update_form(),a(this).hasClass("eo-all-day-toggle")||c.update_occurrencepicker_rules()}),this.update_schedule(),this.update_form();var d=new Date;eo_viewing_month=[d.getFullYear(),d.getMonth()+1],this.schedule.generate_dates_by_rule(d.getFullYear(),d.getMonth()+1,{})},set_up_datepickers:function(){{var b=this,c=this.options.views,d=this.options.locale;a(c.start_date).data("eo-datepicker","start"),a(c.end_date).data("eo-datepicker","end")}if(a(c.is_all_day).addClass("eo-all-day-toggle"),a(c.schedule_last_date))var e=a(c.schedule_last_date).datepicker({dateFormat:this.options.format,changeMonth:!0,changeYear:!0,monthNamesShort:d.monthAbbrev,dayNamesMin:d.dayAbbrev,isRTL:d.isrtl,firstDay:parseInt(this.options.startday,10)}).data("eo-datepicker","schedule_last");var f=a(c.start_date+", "+c.end_date).datepicker({dateFormat:this.options.format,changeMonth:!0,changeYear:!0,monthNamesShort:d.monthAbbrev,dayNamesMin:d.dayAbbrev,firstDay:parseInt(this.options.startday,10),onSelect:function(c){var d="start"==a(this).data("eo-datepicker")?"minDate":"maxDate",g=a(this).data("datepicker"),h=a.datepicker.parseDate(g.settings.dateFormat||a.datepicker._defaults.dateFormat,c,g.settings);f.not(this).datepicker("option",d,h),"from_date"==this.id&&e.datepicker("option","minDate",h),b.update_schedule(),b.update_occurrencepicker_rules(),b.update_form()}}),g=a(c.occurrence_picker);g.length>0&&(g.datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,monthNamesShort:d.monthAbbrev,dayNamesMin:d.dayAbbrev,firstDay:parseInt(this.options.startday,10),onSelect:function(b){eventOrganiserSchedule.add_or_remove_date(b),a(eventOrganiserSchedulePicker.options.views.include).val(eventOrganiserSchedule.include.join(",\r\n")),a(eventOrganiserSchedulePicker.options.views.exclude).val(eventOrganiserSchedule.exclude.join(",\r\n"))},beforeShowDay:function(b){var c=a.datepicker.formatDate("yy-mm-dd",b),d=eventOrganiserSchedule.is_date_eventful(c);return d[0]?[!0,"ui-state-active",""]:[!0,"ui-state-disabled",""]},onChangeMonthYear:eventOrganiserSchedule.generate_dates_by_rule}).hide().find(".ui-datepicker-inline").click(function(a){a||(a=window.event),a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()}),a("html").click(function(){g.hide(),a(c.occurrence_picker_toggle).val(d.showDates)})),a(c.occurrence_picker_toggle).click(function(b){b.preventDefault(),b.stopPropagation(),g.toggle(),g.is(":visible")?(a(this).val(d.hideDates),a(c.occurrence_picker).datepicker("refresh")):a(this).val(d.showDates)})},update_occurrencepicker_rules:function(){eo_exclude_dates=[],eo_include_dates=[],this.schedule.generate_dates_by_rule(eo_viewing_month[0],eo_viewing_month[1],{}),a(this.options.views.occurrence_picker).datepicker("refresh")},set_up_timepickers:function(){var b=this.options,c=this.options.views;a(c.start_time+", "+c.end_time).eotimepicker({showPeriodLabels:!b.is24hour,showPeriod:!this.options.is24hour,showLeadingZero:b.is24hour,periodSeparator:"",amPmText:b.locale.meridian,hourText:b.locale.hour,minuteText:b.locale.minute,isRTL:b.locale.isrtl}).addClass("eo-time-picker")},update_schedule:function(){var b=new Array("SU","MO","TU","WE","TH","FR","SA"),c=this.options.views,d={schedule:a(c.schedule).val(),frequency:parseInt(a(c.frequency).val(),10),schedule_last:a(c.schedule_last_date).datepicker("getDate"),start:a(c.start_date).datepicker("getDate"),end:a(c.end_date).datepicker("getDate"),is_all_day:a(c.is_all_day).attr("checked"),include:a(c.include).length>0?a(c.include).val().split(","):[],exclude:a(c.exclude).length>0?a(c.exclude).val().split(","):[]};if("weekly"==d.schedule){if(d.schedule_meta=[],0===a(c.week_repeat+" :checkbox:checked").length){var e=d.start.getDay();a(c.week_repeat+" :checkbox[value='"+b[e]+"']").attr("checked",!0)}a(c.week_repeat+" :checkbox:checked").each(function(){d.schedule_meta.push(a(this).val())})}else if("monthly"==d.schedule)if("BYMONTHDAY="==a(c.month_repeat+" :radio:checked").val())d.schedule_meta="BYMONTHDAY="+d.start.getDate();else{var f=d.start.getDay()%7,g=parseInt(Math.floor((d.start.getDate()-1)/7),10);d.schedule_meta="BYDAY="+(g+1)+b[f]}this.schedule=eventOrganiserSchedule.init(d),eo_exclude_dates=d.exclude,eo_include_dates=d.include},update_form:function(){var b=this.options.views,c=this.options.locale,d=this.schedule,e=700;switch(a(".event-date :input").attr("disabled",!this.options.editable).toggleClass("ui-state-disabled",!this.options.editable),this.options.editable&&a(b.start_time+", "+b.end_time).attr("disabled",d.is_all_day).toggleClass("ui-state-disabled",d.is_all_day),"once"==d.schedule||"custom"==d.schedule?(a(b.recurrence_section+" :input").attr("disabled",!0),a(b.recurrence_section).hide()):(a(b.recurrence_section+" :input").attr("disabled",!1),a(b.recurrence_section).fadeIn(e)),d.schedule){case"once":case"custom":a(d.frequency).val("1"),a(b.month_repeat+", "+b.week_repeat).show();break;case"weekly":a(b.schedule_span).text(d.frequency>1?c.weeks:c.week),a(b.week_repeat).fadeIn(e),a(b.week_repeat+" :input").attr("disabled",!1),a(b.month_repeat).hide(),a(b.month_repeat+" :input").attr("disabled",!0);break;case"monthly":a(b.schedule_span).text(d.frequency>1?c.months:c.month),a(b.month_repeat).fadeIn(e),a(b.month_repeat+" :input").attr("disabled",!1),a(b.week_repeat).hide(),a(b.week_repeat+" :input").attr("disabled",!0);break;case"daily":a(b.schedule_span).text(d.frequency>1?c.days:c.day),a(b.week_repeat+", "+b.month_repeat).hide(),a(b.week_repeat+" :input, "+b.month_repeat+" :input").attr("disabled",!0);break;case"yearly":a(b.schedule_span).text(d.frequency>1?c.years:c.year),a(b.week_repeat+", "+b.month_repeat).hide(),a(b.week_repeat+" :input, "+b.month_repeat+" :input").attr("disabled",!0)}null===a("#venue_select").val()&&a("tr.venue_row").hide(),a(b.summary).html(d.generate_summary(c))}},eventOrganiserSchedule={self:this,init:function(b){var c={schedule:"once",frequency:1,schedule_last:new Date,start:new Date,end:new Date,is_all_day:!1,dates_by_rule:[]};b=a.extend({},c,b);for(var d in b)this[d]=b[d];return this},generate_dates_by_rule:function(a,c){var d=new Date(a,c-1,1),e=new Date(a,c,1),f=new Date(e-1);eventOrganiserSchedule.schedule_last<d||eventOrganiserSchedule.start>f||(eventOrganiserSchedule.dates_by_rule=b(eventOrganiserSchedule,d,f))},generate_summary:function(b){var c=b.weekDay,d=b.summary+" ",e={monthNamesShort:b.monthAbbrev,dayNamesMin:b.dayAbbrev,monthNames:b.monthNames},f=this.schedule,g=new Array("SU","MO","TU","WE","TH","FR","SA");switch(f){case"once":return"This event will be a one-time event";case"custom":case"daily":d+=this.frequency>1?sprintf(b.dayPlural,this.frequency):b.daySingle;break;case"weekly":d+=this.frequency>1?sprintf(b.weekPlural,this.frequency):b.weekSingle;var h=a.map(this.schedule_meta,function(a){return c[g.indexOf(a)]});d+=" "+h.join(", ");break;case"monthly":if(d+=this.frequency>1?sprintf(b.monthPlural,this.frequency):b.monthSingle,this.schedule_meta.match(/BYMONTHDAY=(\d+)/))d=d+" "+this.start.getDate()+this.start.eoGetOrdinal();else{var i=this.schedule_meta.match(/BYDAY=(\d+)(MO|TU|WE|TH|FR|SA|SU)/),j=parseInt(i[1],10)-1;d=d+" "+b.occurrence[j]+" "+c[g.indexOf(i[2])]}break;case"yearly":d+=this.frequency>1?sprintf(b.yearPlural,this.frequency):b.yearSingle,d=d+" "+a.datepicker.formatDate("MM d",this.start,e)+this.start.eoGetOrdinal()}return null!==this.schedule_last&&(d=d+" "+b.until+" "+a.datepicker.formatDate("MM d'"+this.schedule_last.eoGetOrdinal()+"' yy",this.schedule_last,e)),d},is_date_eventful:function(b){var c=a.inArray(b,eventOrganiserSchedule.dates_by_rule);if(c>-1){var d=a.inArray(b,eventOrganiserSchedule.exclude);return d>-1?[!1,d]:[!0,-1]}var e=a.inArray(b,eventOrganiserSchedule.include);return e>-1?[!0,e]:[!1,-1]},add_or_remove_date:function(b){var c,d=eventOrganiserSchedule.is_date_eventful(b);d[0]?(c=d[1],c>-1?eventOrganiserSchedule.include.splice(c,1):a.inArray(b,eventOrganiserSchedule.exclude)<0&&eventOrganiserSchedule.exclude.push(b)):(c=d[1],c>-1?eventOrganiserSchedule.exclude.splice(c,1):a.inArray(b,eventOrganiserSchedule.include)<0&&eventOrganiserSchedule.include.push(b)),eo_exclude_dates=eventOrganiserSchedule.exclude,eo_include_dates=eventOrganiserSchedule.include}}}(jQuery),function(a){function b(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function c(a,b){for(var c=[];b>0;c[--b]=a);return c.join("")}var d=function(){return d.cache.hasOwnProperty(arguments[0])||(d.cache[arguments[0]]=d.parse(arguments[0])),d.format.call(null,d.cache[arguments[0]],arguments)};d.format=function(a,e){var f,g,h,i,j,k,l,m=1,n=a.length,o="",p=[];for(g=0;n>g;g++)if(o=b(a[g]),"string"===o)p.push(a[g]);else if("array"===o){if(i=a[g],i[2])for(f=e[m],h=0;h<i[2].length;h++){if(!f.hasOwnProperty(i[2][h]))throw d('[sprintf] property "%s" does not exist',i[2][h]);f=f[i[2][h]]}else f=i[1]?e[i[1]]:e[m++];if(/[^s]/.test(i[8])&&"number"!=b(f))throw d("[sprintf] expecting number but found %s",b(f));switch(i[8]){case"b":f=f.toString(2);break;case"c":f=String.fromCharCode(f);break;case"d":f=parseInt(f,10);break;case"e":f=i[7]?f.toExponential(i[7]):f.toExponential();break;case"f":f=i[7]?parseFloat(f).toFixed(i[7]):parseFloat(f);break;case"o":f=f.toString(8);break;case"s":f=(f=String(f))&&i[7]?f.substring(0,i[7]):f;break;case"u":f>>>=0;break;case"x":f=f.toString(16);break;case"X":f=f.toString(16).toUpperCase()}f=/[def]/.test(i[8])&&i[3]&&f>=0?"+"+f:f,k=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",l=i[6]-String(f).length,j=i[6]?c(k,l):"",p.push(i[5]?f+j:j+f)}return p.join("")},d.cache={},d.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw"[sprintf] huh?";if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw"[sprintf] huh?";for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw"[sprintf] huh?";f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";d.push(c)}b=b.substring(c[0].length)}return d};var e=function(a,b,c){return c=b.slice(0),c.splice(0,0,a),d.apply(null,c)};a.sprintf=d,a.vsprintf=e}("undefined"!=typeof exports?exports:window);